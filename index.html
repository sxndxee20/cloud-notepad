<!DOCTYPE html>
<html lang="en" data-color-mode="dark" data-dark-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cloud Notepad Pro</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìù</text></svg>">
  <style>
    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       GitHub Primer Dark Theme - Design Tokens
       ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    :root {
      /* Canvas */
      --color-canvas-default: #0d1117;
      --color-canvas-subtle: #161b22;
      --color-canvas-inset: #010409;
      --color-canvas-overlay: #1c2128;

      /* Border */
      --color-border-default: #30363d;
      --color-border-muted: #21262d;
      --color-border-subtle: rgba(240,246,252,0.1);

      /* Text */
      --color-fg-default: #e6edf3;
      --color-fg-muted: #8b949e;
      --color-fg-subtle: #6e7681;
      --color-fg-on-emphasis: #ffffff;

      /* Accent */
      --color-accent-fg: #58a6ff;
      --color-accent-emphasis: #1f6feb;
      --color-accent-muted: rgba(56,139,253,0.4);
      --color-accent-subtle: rgba(56,139,253,0.15);

      /* Success */
      --color-success-fg: #3fb950;
      --color-success-emphasis: #238636;
      --color-success-subtle: rgba(46,160,67,0.15);

      /* Danger */
      --color-danger-fg: #f85149;
      --color-danger-emphasis: #da3633;
      --color-danger-subtle: rgba(248,81,73,0.15);

      /* Attention */
      --color-attention-fg: #d29922;
      --color-attention-subtle: rgba(187,128,9,0.15);

      /* Neutral */
      --color-neutral-emphasis: #6e7681;
      --color-neutral-muted: rgba(110,118,129,0.4);
      --color-neutral-subtle: rgba(110,118,129,0.1);

      /* Btn */
      --color-btn-bg: #21262d;
      --color-btn-border: rgba(240,246,252,0.1);
      --color-btn-hover-bg: #30363d;
      --color-btn-hover-border: #8b949e;
      --color-btn-primary-bg: #238636;
      --color-btn-primary-hover-bg: #2ea043;
      --color-btn-primary-border: rgba(240,246,252,0.1);
      --color-btn-danger-bg: rgba(248,81,73,0.1);
      --color-btn-danger-hover-bg: #da3633;

      /* Header */
      --color-header-bg: #161b22;
      --color-header-border: #30363d;

      /* Typography */
      --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
      --font-mono: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, "Liberation Mono", monospace;

      --text-body-size: 14px;
      --text-small-size: 12px;
    }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Reset ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    html {
      font-size: 16px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    body {
      font-family: var(--font-sans);
      font-size: var(--text-body-size);
      line-height: 1.5;
      color: var(--color-fg-default);
      background-color: var(--color-canvas-default);
      min-height: 100vh;
    }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Scrollbar (GitHub style) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: var(--color-canvas-default); }
    ::-webkit-scrollbar-thumb { background: var(--color-border-default); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--color-fg-subtle); }
    html { scrollbar-color: var(--color-border-default) var(--color-canvas-default); }

    .hidden { display: none !important; }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Header (GitHub top nav style) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .AppHeader {
      background: var(--color-header-bg);
      border-bottom: 1px solid var(--color-header-border);
      padding: 0 16px;
      height: 48px;
      display: flex;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .AppHeader-content {
      max-width: 1280px;
      width: 100%;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .AppHeader-brand {
      display: flex;
      align-items: center;
      gap: 12px;
      text-decoration: none;
      color: var(--color-fg-default);
    }

    .AppHeader-logo {
      color: var(--color-fg-default);
      display: flex;
    }

    .AppHeader-logo svg { width: 32px; height: 32px; fill: currentColor; }

    .AppHeader-title {
      font-size: 16px;
      font-weight: 600;
      line-height: 1;
      white-space: nowrap;
    }

    .AppHeader-title small {
      display: block;
      font-size: 11px;
      font-weight: 400;
      color: var(--color-fg-subtle);
      margin-top: 1px;
    }

    .AppHeader-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* Status label (GitHub label component) */
    .Label {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 0 8px;
      height: 24px;
      font-size: var(--text-small-size);
      font-weight: 500;
      border-radius: 12px;
      border: 1px solid var(--color-border-default);
      background: var(--color-canvas-subtle);
      color: var(--color-fg-muted);
      white-space: nowrap;
    }

    .Label-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--color-fg-subtle);
      flex-shrink: 0;
    }

    .Label-dot.connected {
      background: var(--color-success-fg);
      box-shadow: 0 0 6px rgba(63,185,80,0.4);
    }

    /* Keyboard shortcut hint */
    .Kbd {
      display: none;
      align-items: center;
      gap: 4px;
      font-size: 11px;
      color: var(--color-fg-subtle);
    }

    .Kbd kbd {
      font-family: var(--font-mono);
      font-size: 11px;
      font-weight: 500;
      background: var(--color-canvas-subtle);
      border: 1px solid var(--color-border-default);
      border-radius: 4px;
      padding: 1px 5px;
      color: var(--color-fg-muted);
      box-shadow: inset 0 -1px 0 var(--color-border-muted);
    }

    @media (min-width: 1024px) { .Kbd { display: flex; } }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Layout ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .Layout {
      max-width: 1280px;
      margin: 0 auto;
      padding: 24px 16px;
      display: grid;
      grid-template-columns: 1fr 340px;
      gap: 24px;
      min-height: calc(100vh - 48px);
    }

    .Layout-main {
      display: flex;
      flex-direction: column;
      gap: 16px;
      min-width: 0;
    }

    .Layout-sidebar {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Box (GitHub's bordered box component) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .Box {
      background: var(--color-canvas-subtle);
      border: 1px solid var(--color-border-default);
      border-radius: 6px;
    }

    .Box-header {
      padding: 12px 16px;
      border-bottom: 1px solid var(--color-border-default);
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: var(--color-canvas-subtle);
      border-radius: 6px 6px 0 0;
    }

    .Box-title {
      font-size: var(--text-body-size);
      font-weight: 600;
      color: var(--color-fg-default);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .Box-title svg {
      width: 16px;
      height: 16px;
      color: var(--color-fg-muted);
      flex-shrink: 0;
    }

    .Box-body {
      padding: 16px;
    }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Editor ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .editor-box {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .editor-box .Box-body {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 0;
    }

    .editor-textarea {
      flex: 1;
      width: 100%;
      min-height: 480px;
      padding: 16px;
      border: none;
      border-radius: 0 0 6px 6px;
      background: var(--color-canvas-default);
      color: var(--color-fg-default);
      font-family: var(--font-mono);
      font-size: 13px;
      line-height: 1.6;
      resize: vertical;
      outline: none;
    }

    .editor-textarea::placeholder {
      color: var(--color-fg-subtle);
    }

    .editor-textarea:focus {
      box-shadow: inset 0 0 0 1px var(--color-accent-emphasis);
    }

    .editor-stats {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .Counter {
      font-family: var(--font-mono);
      font-size: 11px;
      font-weight: 500;
      color: var(--color-fg-muted);
      background: var(--color-neutral-subtle);
      padding: 1px 8px;
      border-radius: 10px;
    }

    .Counter span { color: var(--color-fg-default); font-weight: 600; }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Form Controls (GitHub style) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .FormControl {
      margin-bottom: 12px;
    }

    .FormControl:last-child { margin-bottom: 0; }

    .FormControl-label {
      display: block;
      font-size: var(--text-small-size);
      font-weight: 600;
      color: var(--color-fg-default);
      margin-bottom: 4px;
    }

    .FormControl-caption {
      font-size: var(--text-small-size);
      color: var(--color-fg-subtle);
      margin-top: 4px;
    }

    .FormControl-input {
      width: 100%;
      padding: 5px 12px;
      font-size: var(--text-body-size);
      font-family: var(--font-mono);
      line-height: 20px;
      color: var(--color-fg-default);
      background: var(--color-canvas-default);
      border: 1px solid var(--color-border-default);
      border-radius: 6px;
      outline: none;
      transition: border-color 0.15s ease, box-shadow 0.15s ease;
    }

    .FormControl-input:focus {
      border-color: var(--color-accent-emphasis);
      box-shadow: 0 0 0 3px var(--color-accent-muted);
    }

    .FormControl-input::placeholder { color: var(--color-fg-subtle); }

    .FormControl-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .FormControl-grid .FormControl { margin-bottom: 0; }

    .FormControl-inputWrap {
      position: relative;
    }

    .FormControl-toggleBtn {
      position: absolute;
      right: 4px;
      top: 50%;
      transform: translateY(-50%);
      font-family: var(--font-mono);
      font-size: 10px;
      font-weight: 600;
      letter-spacing: 0.02em;
      color: var(--color-fg-muted);
      background: var(--color-canvas-subtle);
      border: 1px solid var(--color-border-default);
      border-radius: 4px;
      padding: 2px 8px;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .FormControl-toggleBtn:hover {
      color: var(--color-accent-fg);
      border-color: var(--color-accent-fg);
    }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Buttons (GitHub's btn component) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .BtnGroup {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      margin-top: 16px;
    }

    .btn-gh {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 5px 16px;
      font-family: var(--font-sans);
      font-size: var(--text-body-size);
      font-weight: 500;
      line-height: 20px;
      white-space: nowrap;
      border-radius: 6px;
      cursor: pointer;
      transition: 0.15s ease;
      border: 1px solid;
      position: relative;
      user-select: none;
    }

    .btn-gh svg {
      width: 16px;
      height: 16px;
      flex-shrink: 0;
    }

    .btn-gh:active:not(:disabled) { transform: scale(0.98); }

    .btn-gh:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Default button */
    .btn-default {
      color: var(--color-fg-default);
      background: var(--color-btn-bg);
      border-color: var(--color-btn-border);
    }

    .btn-default:hover:not(:disabled) {
      background: var(--color-btn-hover-bg);
      border-color: var(--color-btn-hover-border);
    }

    /* Primary (green) */
    .btn-primary-gh {
      color: var(--color-fg-on-emphasis);
      background: var(--color-btn-primary-bg);
      border-color: var(--color-btn-primary-border);
      box-shadow: 0 1px 0 rgba(1,4,9,0.1);
    }

    .btn-primary-gh:hover:not(:disabled) {
      background: var(--color-btn-primary-hover-bg);
    }

    /* Outline (blue) */
    .btn-outline {
      color: var(--color-accent-fg);
      background: transparent;
      border-color: var(--color-btn-border);
    }

    .btn-outline:hover:not(:disabled) {
      color: var(--color-fg-on-emphasis);
      background: var(--color-accent-emphasis);
      border-color: var(--color-accent-emphasis);
    }

    /* Danger */
    .btn-danger-gh {
      color: var(--color-danger-fg);
      background: transparent;
      border-color: var(--color-btn-border);
    }

    .btn-danger-gh:hover:not(:disabled) {
      color: var(--color-fg-on-emphasis);
      background: var(--color-btn-danger-hover-bg);
      border-color: var(--color-danger-emphasis);
    }

    .btn-full { grid-column: 1 / -1; }

    /* Spinner */
    .btn-gh .spinner {
      width: 14px;
      height: 14px;
      border: 2px solid rgba(255,255,255,0.2);
      border-top-color: currentColor;
      border-radius: 50%;
      animation: spin 0.6s linear infinite;
      display: none;
    }
    .btn-gh.loading .spinner { display: block; }
    .btn-gh.loading .btn-text { opacity: 0.7; }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* File Input */
    .file-input-wrapper { position: relative; overflow: hidden; width: 100%; }
    .file-input-wrapper input[type=file] { position: absolute; left: -9999px; }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Image Preview ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .preview-img-wrap {
      border-radius: 6px;
      overflow: hidden;
      border: 1px solid var(--color-border-default);
      background: var(--color-canvas-inset);
    }

    .preview-img-wrap img {
      width: 100%;
      height: auto;
      display: block;
      max-height: 500px;
      object-fit: contain;
    }

    /* Blankslate (GitHub empty state) */
    .Blankslate {
      text-align: center;
      padding: 32px 16px;
    }

    .Blankslate svg {
      width: 40px;
      height: 40px;
      color: var(--color-fg-subtle);
      margin-bottom: 12px;
      opacity: 0.4;
    }

    .Blankslate h3 {
      font-size: var(--text-body-size);
      font-weight: 500;
      color: var(--color-fg-muted);
    }

    .Blankslate p {
      font-size: var(--text-small-size);
      color: var(--color-fg-subtle);
      margin-top: 4px;
    }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê File Info (GitHub list style) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .info-list { list-style: none; }

    .info-list-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 16px;
      font-size: var(--text-small-size);
      border-top: 1px solid var(--color-border-muted);
    }

    .info-list-item:first-child { border-top: none; }

    .info-list-label {
      font-weight: 600;
      color: var(--color-fg-muted);
    }

    .info-list-value {
      font-family: var(--font-mono);
      font-size: var(--text-small-size);
      color: var(--color-fg-default);
    }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Flash (GitHub alert / toast) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .Flash {
      padding: 12px 16px;
      border-radius: 6px;
      font-size: var(--text-body-size);
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 16px;
      border: 1px solid;
      animation: flash-in 0.25s ease;
    }

    @keyframes flash-in {
      from { opacity: 0; transform: translateY(-4px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .Flash-icon {
      width: 16px;
      height: 16px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
    }

    .Flash--success {
      background: var(--color-success-subtle);
      border-color: rgba(46,160,67,0.4);
      color: var(--color-success-fg);
    }

    .Flash--error {
      background: var(--color-danger-subtle);
      border-color: rgba(248,81,73,0.4);
      color: var(--color-danger-fg);
    }

    .Flash--info {
      background: var(--color-accent-subtle);
      border-color: rgba(56,139,253,0.4);
      color: var(--color-accent-fg);
    }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Divider ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .Divider {
      height: 1px;
      background: var(--color-border-muted);
      margin: 12px 0;
      border: none;
    }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Responsive ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    @media (max-width: 1012px) {
      .Layout { grid-template-columns: 1fr; }
      .Layout-sidebar { order: -1; }
    }

    @media (max-width: 544px) {
      .AppHeader { padding: 0 8px; }
      .Layout { padding: 16px 8px; gap: 12px; }
      .BtnGroup { grid-template-columns: 1fr; }
      .FormControl-grid { grid-template-columns: 1fr; }
      .editor-textarea { min-height: 300px; }
    }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Panel Swap ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    #editorPanelHost, #previewPanelHost { transition: opacity 0.15s ease; }
  </style>
</head>

<body>
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Header ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <header class="AppHeader">
    <div class="AppHeader-content">
      <a class="AppHeader-brand" href="#">
        <span class="AppHeader-logo">
          <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
          </svg>
        </span>
        <span class="AppHeader-title">
          Cloud Notepad Pro
          <small>Developer Edition</small>
        </span>
      </a>

      <div class="AppHeader-actions">
        <div class="Kbd">
          <kbd>Ctrl</kbd>+<kbd>S</kbd> Save
        </div>
        <div class="Label">
          <span class="Label-dot" id="statusDot"></span>
          <span id="statusText">Not Connected</span>
        </div>
      </div>
    </div>
  </header>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê Main Layout ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <main class="Layout">
    <!-- Editor Section -->
    <section class="Layout-main">
      <div id="statusMessage"></div>

      <div id="editorPanelHost">
        <div class="Box editor-box" id="editorPanel">
          <div class="Box-header">
            <h2 class="Box-title">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M11.013 1.427a1.75 1.75 0 0 1 2.474 0l1.086 1.086a1.75 1.75 0 0 1 0 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 0 1-.927-.928l.929-3.25c.081-.286.235-.547.445-.758l8.61-8.61Zm.176 4.823L9.75 4.81l-6.286 6.287a.253.253 0 0 0-.064.108l-.558 1.953 1.953-.558a.253.253 0 0 0 .108-.064Zm1.238-3.763a.25.25 0 0 0-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 0 0 0-.354Z"/></svg>
              Editor
            </h2>
            <div class="editor-stats">
              <span class="Counter"><span id="charCount">0</span> chars</span>
              <span class="Counter"><span id="wordCount">0</span> words</span>
              <span class="Counter"><span id="lineCount">1</span> lines</span>
            </div>
          </div>
          <div class="Box-body">
            <textarea id="textEditor" class="editor-textarea" placeholder="Start typing your notes here...&#10;&#10;Supports plain text, code, markdown, and more.&#10;Content is saved to GitHub when you click Save.&#10;&#10;Shortcuts:  Ctrl+S = Save  |  Ctrl+O = Load"></textarea>
          </div>
        </div>
      </div>
    </section>

    <!-- Sidebar -->
    <aside class="Layout-sidebar">
      <!-- Config -->
      <div class="Box">
        <div class="Box-header">
          <h2 class="Box-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0a8.2 8.2 0 0 1 .701.031C6.444.095 4.683.85 3.39 2.005a.75.75 0 0 0 .488 1.31h.006a5.77 5.77 0 0 1 3.042-.023A8.2 8.2 0 0 1 8 3.25c.9 0 1.786.099 2.636.345C11.5 2.6 12.628 2 14 2c.368.063.66.33.748.69a8.2 8.2 0 0 1 .256 1.81v.07c0 0 0 0 0 0s.002.084.005.127A8.002 8.002 0 0 1 8 16 8 8 0 0 1 .004 8.006l.003-.063-.003.063A8 8 0 0 1 8 0Z"/></svg>
            Configuration
          </h2>
        </div>
        <div class="Box-body">
          <div class="FormControl">
            <label class="FormControl-label" for="githubToken">Personal Access Token</label>
            <div class="FormControl-inputWrap">
              <input type="password" id="githubToken" class="FormControl-input" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx">
              <button type="button" class="FormControl-toggleBtn" id="toggleToken">SHOW</button>
            </div>
            <p class="FormControl-caption">Generate at github.com/settings/tokens with repo scope</p>
          </div>

          <div class="FormControl-grid">
            <div class="FormControl">
              <label class="FormControl-label" for="githubOwner">Owner</label>
              <input type="text" id="githubOwner" class="FormControl-input" placeholder="username">
            </div>
            <div class="FormControl">
              <label class="FormControl-label" for="githubRepo">Repository</label>
              <input type="text" id="githubRepo" class="FormControl-input" placeholder="my-notes">
            </div>
          </div>

          <div class="FormControl-grid" style="margin-top:12px;">
            <div class="FormControl">
              <label class="FormControl-label" for="githubBranch">Branch</label>
              <input type="text" id="githubBranch" class="FormControl-input" placeholder="main" value="main">
            </div>
            <div class="FormControl">
              <label class="FormControl-label" for="fileName">File Name</label>
              <input type="text" id="fileName" class="FormControl-input" placeholder="notes.txt" value="notes.txt">
            </div>
          </div>

          <hr class="Divider">

          <div class="BtnGroup">
            <button id="loadFileBtn" class="btn-gh btn-outline">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M2.75 14A1.75 1.75 0 0 1 1 12.25v-2.5a.75.75 0 0 1 1.5 0v2.5c0 .138.112.25.25.25h10.5a.25.25 0 0 0 .25-.25v-2.5a.75.75 0 0 1 1.5 0v2.5A1.75 1.75 0 0 1 13.25 14ZM7.25 7.689V2a.75.75 0 0 1 1.5 0v5.689l1.97-1.969a.749.749 0 1 1 1.06 1.06l-3.25 3.25a.749.749 0 0 1-1.06 0L4.22 6.78a.749.749 0 1 1 1.06-1.06l1.97 1.969Z"/></svg>
              <span class="btn-text">Load File</span>
              <span class="spinner"></span>
            </button>
            <button id="loadImageBtn" class="btn-gh btn-outline">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M16 13.25A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25V2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75ZM1.75 2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h.94l5.702-6.322a.75.75 0 0 1 1.116 0l5.702 6.322h.94a.25.25 0 0 0 .25-.25V2.75a.25.25 0 0 0-.25-.25ZM5.5 6a1.5 1.5 0 1 1-3.001-.001A1.5 1.5 0 0 1 5.5 6Z"/></svg>
              <span class="btn-text">Load Image</span>
              <span class="spinner"></span>
            </button>
            <div class="file-input-wrapper">
              <label for="fileInput" class="btn-gh btn-default" style="width:100%; display:flex;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M3.75 1.5a.25.25 0 0 0-.25.25v12.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25V6H9.75A1.75 1.75 0 0 1 8 4.25V1.5ZM10 4.25c0 .138.112.25.25.25h2.184L10 2.189ZM3.75 0h5.086c.464 0 .909.184 1.237.513l3.414 3.414c.329.328.513.773.513 1.237v9.086A1.75 1.75 0 0 1 12.25 16h-8.5A1.75 1.75 0 0 1 2 14.25V1.75C2 .784 2.784 0 3.75 0Z"/></svg>
                <span class="btn-text">Local File</span>
              </label>
              <input type="file" id="fileInput" accept="image/*">
            </div>
            <button id="saveFileBtn" class="btn-gh btn-primary-gh">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M.143 2.31a.75.75 0 0 1 1.047-.167l4.31 3.106 4.31-3.106a.75.75 0 0 1 .88 1.214l-3.558 2.564 3.558 2.563a.75.75 0 1 1-.88 1.215l-4.31-3.106-4.31 3.106a.75.75 0 0 1-.88-1.215l3.558-2.563L.31 3.357A.75.75 0 0 1 .143 2.31Z"/></svg>
              <span class="btn-text">Save File</span>
              <span class="spinner"></span>
            </button>
            <button id="clearTextBtn" class="btn-gh btn-danger-gh btn-full">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M11 1.75V3h2.25a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1 0-1.5H5V1.75C5 .784 5.784 0 6.75 0h2.5C10.216 0 11 .784 11 1.75ZM4.496 6.675l.66 6.6a.25.25 0 0 0 .249.225h5.19a.25.25 0 0 0 .249-.225l.66-6.6a.75.75 0 0 1 1.492.149l-.66 6.6A1.748 1.748 0 0 1 10.595 15h-5.19a1.75 1.75 0 0 1-1.741-1.575l-.66-6.6a.75.75 0 1 1 1.492-.15ZM6.5 1.75V3h3V1.75a.25.25 0 0 0-.25-.25h-2.5a.25.25 0 0 0-.25.25Z"/></svg>
              <span class="btn-text">Clear All</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Preview -->
      <div id="previewPanelHost">
        <div class="Box" id="previewPanel">
          <div class="Box-header">
            <h2 class="Box-title">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M8 2c1.981 0 3.671.992 4.933 2.078 1.27 1.091 2.187 2.345 2.637 3.023a1.62 1.62 0 0 1 0 1.798c-.45.678-1.367 1.932-2.637 3.023C11.671 13.008 9.981 14 8 14c-1.981 0-3.671-.992-4.933-2.078C1.797 10.83.88 9.576.43 8.898a1.62 1.62 0 0 1 0-1.798c.45-.677 1.367-1.931 2.637-3.022C4.329 2.992 6.019 2 8 2ZM1.679 7.932a.12.12 0 0 0 0 .136c.411.622 1.241 1.75 2.366 2.717C5.176 11.758 6.527 12.5 8 12.5c1.473 0 2.825-.742 3.955-1.715 1.124-.967 1.954-2.096 2.366-2.717a.12.12 0 0 0 0-.136c-.412-.621-1.242-1.75-2.366-2.717C10.824 4.242 9.473 3.5 8 3.5c-1.473 0-2.824.742-3.955 1.715-1.124.967-1.954 2.096-2.366 2.717ZM8 10a2 2 0 1 1-.001-3.999A2 2 0 0 1 8 10Z"/></svg>
              Preview
            </h2>
          </div>
          <div class="Box-body">
            <div id="imagePreviewContainer" class="hidden">
              <div class="preview-img-wrap">
                <img id="imagePreview" alt="Image preview">
              </div>
            </div>
            <div id="noPreview" class="Blankslate">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor">
                <path d="M16 13.25A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25V2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75ZM1.75 2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h.94l5.702-6.322a.75.75 0 0 1 1.116 0l5.702 6.322h.94a.25.25 0 0 0 .25-.25V2.75a.25.25 0 0 0-.25-.25ZM5.5 6a1.5 1.5 0 1 1-3.001-.001A1.5 1.5 0 0 1 5.5 6Z"/>
              </svg>
              <h3>No preview available</h3>
              <p>Load an image to see it here</p>
            </div>
          </div>
        </div>
      </div>

      <!-- File Info -->
      <div class="Box">
        <div class="Box-header">
          <h2 class="Box-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"/></svg>
            File Info
          </h2>
        </div>
        <ul class="info-list">
          <li class="info-list-item">
            <span class="info-list-label">Status</span>
            <span class="info-list-value" id="fileStatus">Not Loaded</span>
          </li>
          <li class="info-list-item">
            <span class="info-list-label">Size</span>
            <span class="info-list-value" id="fileSize">0 B</span>
          </li>
          <li class="info-list-item">
            <span class="info-list-label">Type</span>
            <span class="info-list-value" id="fileType">text/plain</span>
          </li>
          <li class="info-list-item">
            <span class="info-list-label">Modified</span>
            <span class="info-list-value" id="lastModified">Never</span>
          </li>
        </ul>
      </div>
    </aside>
  </main>

  <script>
    class CloudNotepadPro {
      constructor() {
        this.currentSHA = null;
        this.currentFileType = 'text';
        this.initializeElements();
        this.attachEventListeners();
        this.loadFromLocalStorage();
        this.updateEditorStats();
        this.updatePanelLayout();
      }

      initializeElements() {
        this.elements = {
          githubToken: document.getElementById('githubToken'),
          githubOwner: document.getElementById('githubOwner'),
          githubRepo: document.getElementById('githubRepo'),
          githubBranch: document.getElementById('githubBranch'),
          fileName: document.getElementById('fileName'),
          textEditor: document.getElementById('textEditor'),
          loadFileBtn: document.getElementById('loadFileBtn'),
          loadImageBtn: document.getElementById('loadImageBtn'),
          fileInput: document.getElementById('fileInput'),
          saveFileBtn: document.getElementById('saveFileBtn'),
          clearTextBtn: document.getElementById('clearTextBtn'),
          statusMessage: document.getElementById('statusMessage'),
          statusDot: document.getElementById('statusDot'),
          statusText: document.getElementById('statusText'),
          fileStatus: document.getElementById('fileStatus'),
          lastModified: document.getElementById('lastModified'),
          fileSize: document.getElementById('fileSize'),
          fileType: document.getElementById('fileType'),
          charCount: document.getElementById('charCount'),
          wordCount: document.getElementById('wordCount'),
          lineCount: document.getElementById('lineCount'),
          editorPanel: document.getElementById('editorPanel'),
          previewPanel: document.getElementById('previewPanel'),
          editorPanelHost: document.getElementById('editorPanelHost'),
          previewPanelHost: document.getElementById('previewPanelHost'),
          imagePreview: document.getElementById('imagePreview'),
          imagePreviewContainer: document.getElementById('imagePreviewContainer'),
          noPreview: document.getElementById('noPreview'),
          toggleToken: document.getElementById('toggleToken')
        };
      }

      attachEventListeners() {
        this.elements.loadFileBtn.addEventListener('click', () => this.loadFile());
        this.elements.loadImageBtn.addEventListener('click', () => this.loadImage());
        this.elements.fileInput.addEventListener('change', (e) => this.handleLocalFile(e));
        this.elements.saveFileBtn.addEventListener('click', () => this.saveFile());
        this.elements.clearTextBtn.addEventListener('click', () => this.clearText());
        this.elements.toggleToken.addEventListener('click', () => this.toggleTokenVisibility());

        this.elements.textEditor.addEventListener('input', () => this.updateEditorStats());

        ['githubToken', 'githubOwner', 'githubRepo', 'githubBranch'].forEach(id => {
          this.elements[id].addEventListener('change', () => this.saveToLocalStorage());
        });

        document.addEventListener('keydown', (e) => {
          if ((e.ctrlKey || e.metaKey) && e.key === 's') {
            e.preventDefault();
            this.saveFile();
          }
          if ((e.ctrlKey || e.metaKey) && e.key === 'o') {
            e.preventDefault();
            this.loadFile();
          }
        });
      }

      toggleTokenVisibility() {
        const tokenInput = this.elements.githubToken;
        const toggleBtn = this.elements.toggleToken;
        if (tokenInput.type === 'password') {
          tokenInput.type = 'text';
          toggleBtn.textContent = 'HIDE';
        } else {
          tokenInput.type = 'password';
          toggleBtn.textContent = 'SHOW';
        }
      }

      updateEditorStats() {
        const text = this.elements.textEditor.value;
        const chars = text.length;
        const words = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
        const lines = text.split('\n').length;
        this.elements.charCount.textContent = chars.toLocaleString();
        this.elements.wordCount.textContent = words.toLocaleString();
        this.elements.lineCount.textContent = lines.toLocaleString();
      }

      updatePanelLayout() {
        if (this.currentFileType === 'image') {
          if (this.elements.editorPanelHost.contains(this.elements.editorPanel)) {
            this.elements.previewPanelHost.appendChild(this.elements.editorPanel);
          }
          if (!this.elements.editorPanelHost.contains(this.elements.previewPanel)) {
            this.elements.editorPanelHost.appendChild(this.elements.previewPanel);
          }
        } else {
          if (!this.elements.editorPanelHost.contains(this.elements.editorPanel)) {
            this.elements.editorPanelHost.appendChild(this.elements.editorPanel);
          }
          if (!this.elements.previewPanelHost.contains(this.elements.previewPanel)) {
            this.elements.previewPanelHost.appendChild(this.elements.previewPanel);
          }
        }
      }

      saveToLocalStorage() {
        localStorage.setItem('github_token', this.elements.githubToken.value);
        localStorage.setItem('github_owner', this.elements.githubOwner.value);
        localStorage.setItem('github_repo', this.elements.githubRepo.value);
        localStorage.setItem('github_branch', this.elements.githubBranch.value);
        this.updateConnectionStatus();
      }

      loadFromLocalStorage() {
        this.elements.githubToken.value = localStorage.getItem('github_token') || '';
        this.elements.githubOwner.value = localStorage.getItem('github_owner') || '';
        this.elements.githubRepo.value = localStorage.getItem('github_repo') || '';
        this.elements.githubBranch.value = localStorage.getItem('github_branch') || 'main';
        this.updateConnectionStatus();
      }

      updateConnectionStatus() {
        const isConfigured = this.elements.githubToken.value &&
          this.elements.githubOwner.value &&
          this.elements.githubRepo.value;

        if (isConfigured) {
          this.elements.statusDot.classList.add('connected');
          this.elements.statusText.textContent = 'Connected';
        } else {
          this.elements.statusDot.classList.remove('connected');
          this.elements.statusText.textContent = 'Not Connected';
        }
      }

      showMessage(message, type) {
        type = type || 'info';
        var icons = { success: '\u2713', error: '\u2715', info: '\u2192' };
        var cls = type === 'success' ? 'Flash--success' :
          type === 'error' ? 'Flash--error' : 'Flash--info';

        this.elements.statusMessage.innerHTML =
          '<div class="Flash ' + cls + '">' +
          '<span class="Flash-icon">' + icons[type] + '</span>' +
          '<span>' + message + '</span>' +
          '</div>';

        setTimeout(() => {
          var el = this.elements.statusMessage.querySelector('.Flash');
          if (el) {
            el.style.opacity = '0';
            el.style.transform = 'translateY(-4px)';
            el.style.transition = 'all 0.2s ease';
            setTimeout(() => { this.elements.statusMessage.innerHTML = ''; }, 200);
          }
        }, 4500);
      }

      validateConfig() {
        if (!this.elements.githubToken.value) {
          this.showMessage('Please enter your GitHub Personal Access Token', 'error');
          return false;
        }
        if (!this.elements.githubOwner.value) {
          this.showMessage('Please enter the repository owner', 'error');
          return false;
        }
        if (!this.elements.githubRepo.value) {
          this.showMessage('Please enter the repository name', 'error');
          return false;
        }
        if (!this.elements.fileName.value) {
          this.showMessage('Please enter a file name', 'error');
          return false;
        }
        return true;
      }

      setButtonLoading(btn, loading) {
        if (loading) btn.classList.add('loading');
        else btn.classList.remove('loading');
      }

      async loadFile() {
        if (!this.validateConfig()) return;

        this.setButtonsDisabled(true);
        this.setButtonLoading(this.elements.loadFileBtn, true);
        this.showMessage('Loading file from GitHub...', 'info');

        try {
          var url = 'https://api.github.com/repos/' + this.elements.githubOwner.value + '/' + this.elements.githubRepo.value + '/contents/' + this.elements.fileName.value + '?ref=' + this.elements.githubBranch.value;

          var response = await fetch(url, {
            headers: {
              'Authorization': 'token ' + this.elements.githubToken.value,
              'Accept': 'application/vnd.github.v3+json'
            }
          });

          if (!response.ok) {
            if (response.status === 404) throw new Error('File not found. It will be created when you save.');
            throw new Error('GitHub API error: ' + response.status);
          }

          var data = await response.json();
          this.currentSHA = data.sha;

          var fileName = this.elements.fileName.value.toLowerCase();
          var isImage = /\.(jpg|jpeg|png|gif|webp|bmp|svg)$/i.test(fileName);

          if (isImage) {
            this.currentFileType = 'image';
            this.elements.textEditor.style.display = 'none';
            this.elements.imagePreviewContainer.classList.remove('hidden');
            this.elements.noPreview.classList.add('hidden');
            this.elements.imagePreview.src = 'data:image/' + fileName.split('.').pop() + ';base64,' + data.content.replace(/\n/g, '');
            this.updatePanelLayout();
            this.showMessage('Image loaded successfully!', 'success');
            this.elements.fileType.textContent = 'image/' + fileName.split('.').pop();
          } else {
            this.currentFileType = 'text';
            this.elements.imagePreviewContainer.classList.add('hidden');
            this.elements.noPreview.classList.remove('hidden');
            this.elements.textEditor.style.display = 'block';
            var decodedContent = decodeURIComponent(escape(atob(data.content.replace(/\n/g, ''))));
            this.elements.textEditor.value = decodedContent;
            this.updateEditorStats();
            this.updatePanelLayout();
            this.showMessage('File loaded successfully!', 'success');
            this.elements.fileType.textContent = 'text/plain';
          }

          this.updateFileInfo(data.size, 'Loaded');
          this.elements.lastModified.textContent = new Date().toLocaleString();
        } catch (error) {
          this.showMessage('Error: ' + error.message, 'error');
          this.currentSHA = null;
          this.elements.fileStatus.textContent = 'Error';
        } finally {
          this.setButtonsDisabled(false);
          this.setButtonLoading(this.elements.loadFileBtn, false);
        }
      }

      async loadImage() {
        var fileName = this.elements.fileName.value.toLowerCase();
        if (!/\.(jpg|jpeg|png|gif|webp|bmp|svg)$/i.test(fileName)) {
          this.showMessage('Please specify an image file (.jpg, .png, .gif, .webp, etc.)', 'error');
          return;
        }
        this.setButtonLoading(this.elements.loadImageBtn, true);
        await this.loadFile();
        this.setButtonLoading(this.elements.loadImageBtn, false);
      }

      handleLocalFile(event) {
        var file = event.target.files[0];
        if (!file) return;

        if (!file.type.startsWith('image/')) {
          this.showMessage('Please select an image file', 'error');
          return;
        }

        var reader = new FileReader();
        reader.onload = (e) => {
          this.elements.imagePreviewContainer.classList.remove('hidden');
          this.elements.noPreview.classList.add('hidden');
          this.elements.imagePreview.src = e.target.result;
          this.elements.textEditor.style.display = 'none';
          this.currentFileType = 'image';
          this.updatePanelLayout();
          this.elements.fileType.textContent = file.type;
          this.updateFileInfo(file.size, 'Local');
          this.showMessage('Local image loaded successfully!', 'success');
        };
        reader.readAsDataURL(file);
      }

      async saveFile() {
        if (!this.validateConfig()) return;

        if (this.currentFileType === 'image') {
          this.showMessage('Image saving not supported. Upload images directly via GitHub.', 'error');
          return;
        }

        this.setButtonsDisabled(true);
        this.setButtonLoading(this.elements.saveFileBtn, true);
        this.showMessage('Saving file to GitHub...', 'info');

        try {
          var content = this.elements.textEditor.value;
          var encodedContent = btoa(unescape(encodeURIComponent(content)));

          var url = 'https://api.github.com/repos/' + this.elements.githubOwner.value + '/' + this.elements.githubRepo.value + '/contents/' + this.elements.fileName.value;

          var body = {
            message: this.currentSHA ? 'Update ' + this.elements.fileName.value : 'Create ' + this.elements.fileName.value,
            content: encodedContent,
            branch: this.elements.githubBranch.value
          };

          if (this.currentSHA) body.sha = this.currentSHA;

          var response = await fetch(url, {
            method: 'PUT',
            headers: {
              'Authorization': 'token ' + this.elements.githubToken.value,
              'Accept': 'application/vnd.github.v3+json',
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(body)
          });

          if (!response.ok) {
            var errorData = await response.json();
            throw new Error(errorData.message || 'GitHub API error: ' + response.status);
          }

          var resData = await response.json();
          this.currentSHA = resData.content.sha;

          this.showMessage('File saved successfully!', 'success');
          this.updateFileInfo(resData.content.size, 'Saved');
          this.elements.lastModified.textContent = new Date().toLocaleString();
        } catch (error) {
          this.showMessage('Error: ' + error.message, 'error');
        } finally {
          this.setButtonsDisabled(false);
          this.setButtonLoading(this.elements.saveFileBtn, false);
        }
      }

      clearText() {
        if (confirm('Clear all content? This cannot be undone.')) {
          this.elements.textEditor.value = '';
          this.elements.imagePreviewContainer.classList.add('hidden');
          this.elements.noPreview.classList.remove('hidden');
          this.elements.textEditor.style.display = 'block';
          this.currentFileType = 'text';
          this.updatePanelLayout();
          this.updateEditorStats();
          this.showMessage('Content cleared', 'info');
          this.updateFileInfo(0, 'Cleared');
          this.elements.fileType.textContent = 'text/plain';
        }
      }

      updateFileInfo(size, status) {
        status = status || 'Unknown';
        this.elements.fileSize.textContent = this.formatBytes(size);
        this.elements.fileStatus.textContent = status;
      }

      formatBytes(bytes) {
        if (bytes === 0) return '0 B';
        var k = 1024;
        var sizes = ['B', 'KB', 'MB', 'GB'];
        var i = Math.floor(Math.log(bytes) / Math.log(k));
        return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
      }

      setButtonsDisabled(disabled) {
        this.elements.loadFileBtn.disabled = disabled;
        this.elements.loadImageBtn.disabled = disabled;
        this.elements.saveFileBtn.disabled = disabled;
        this.elements.clearTextBtn.disabled = disabled;
      }
    }

    var app = new CloudNotepadPro();
  </script>
</body>
</html>